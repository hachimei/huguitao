<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport"
        content="width=device-width, initial-scale=1, maximum-scale=1, minimum-scale=1, user-scalable=no">
    <title>地形开挖</title>
    <link href="../static/Cesium/Widgets/widgets.css" rel="stylesheet" />
    <script src="../static/Cesium/Cesium.js"></script>
    <script src="../static/plugin/TerrainClipPlan.js"></script>
    <style>
        html,
        body,
        #cesiumContainer {
            width: 100%;
            height: 100%;
            margin: 0;
            padding: 0;
            overflow: hidden;
        }

        .tools {
            position: absolute;
            top: 20px;
            left: 12px;
            z-index: 10;
        }
    </style>

</head>

<body>
    <div class="tools">
        <button onclick="terrainClip(true)">地形开挖</button>
        <button onclick="heightChange(~~(Math.random() * 300))">改变高度</button>
    </div>
    <div id="cesiumContainer"></div>
    <script>
        const a0_0x3a7236 = a0_0x1527; (function (_0x2803f1, _0x139c32) { const _0x10d9c6 = a0_0x1527, _0x5086c1 = _0x2803f1(); while (!![]) { try { const _0xf933a1 = -parseInt(_0x10d9c6(0x176)) / 0x1 + -parseInt(_0x10d9c6(0x170)) / 0x2 + -parseInt(_0x10d9c6(0x152)) / 0x3 * (-parseInt(_0x10d9c6(0x15c)) / 0x4) + parseInt(_0x10d9c6(0x12c)) / 0x5 + -parseInt(_0x10d9c6(0x1a4)) / 0x6 + -parseInt(_0x10d9c6(0x1b5)) / 0x7 * (-parseInt(_0x10d9c6(0x15f)) / 0x8) + -parseInt(_0x10d9c6(0x1be)) / 0x9 * (-parseInt(_0x10d9c6(0x14d)) / 0xa); if (_0xf933a1 === _0x139c32) break; else _0x5086c1['push'](_0x5086c1['shift']()); } catch (_0x1a828c) { _0x5086c1['push'](_0x5086c1['shift']()); } } }(a0_0x1bfb, 0x83134)); function a0_0x1527(_0x1ff9b2, _0x2680fe) { const _0x1bfb86 = a0_0x1bfb(); return a0_0x1527 = function (_0x15278d, _0x40e191) { _0x15278d = _0x15278d - 0x122; let _0x37ac9e = _0x1bfb86[_0x15278d]; return _0x37ac9e; }, a0_0x1527(_0x1ff9b2, _0x2680fe); } const Cesium = window[a0_0x3a7236(0x134)], CreatePolygonOnGround = function (_0x1fe51f, _0xc018f1, _0x553a95, _0x498838) { const _0x7f4c4e = a0_0x3a7236; if (!_0x1fe51f) throw new Error('no\x20viewer\x20object!'); _0x553a95 = _0x553a95 || {}; let _0x5b2785 = _0x553a95['id'] || setSessionid(); if (_0x1fe51f[_0x7f4c4e(0x1aa)][_0x7f4c4e(0x15a)](_0x5b2785)) throw new Error(_0x7f4c4e(0x158)); let _0x4f4b69 = _0x553a95['color'] || Cesium[_0x7f4c4e(0x144)][_0x7f4c4e(0x12a)], _0x232494 = _0x553a95[_0x7f4c4e(0x147)] || _0x4f4b69[_0x7f4c4e(0x125)](0x1), _0x598a64 = _0x553a95[_0x7f4c4e(0x151)] || 0x2; const _0x54bdec = new Cesium[(_0x7f4c4e(0x167))](_0x1fe51f['canvas']); let _0x458fdb = _0x7f4c4e(0x1b1), _0x103f6f = [], _0x1530a8 = undefined, _0x3af1e3 = !![]; _0x54bdec[_0x7f4c4e(0x165)](function (_0x8029f) { const _0x469362 = _0x7f4c4e; let _0x396823 = _0x8029f[_0x469362(0x17c)], _0x4dd6c5 = getCatesian3FromPX(_0x1fe51f, _0x396823); if (_0x103f6f[_0x469362(0x1b2)] == 0x0) { _0x458fdb = '左键添加第二个点', _0x103f6f[_0x469362(0x130)](_0x4dd6c5); let _0x4ae146 = new Cesium[(_0x469362(0x191))](function () { const _0x18201f = _0x469362; let _0x44e734 = _0x103f6f[_0x18201f(0x146)]([_0x103f6f[0x0]]); return _0x44e734; }, ![]), _0x571529 = new Cesium[(_0x469362(0x191))](function () { return new Cesium['PolygonHierarchy'](_0x103f6f); }, ![]); _0x1530a8 = _0x1fe51f[_0x469362(0x1aa)][_0x469362(0x1a1)]({ 'name': _0x469362(0x194), 'id': _0x5b2785, 'polyline': { 'positions': _0x4ae146, 'width': _0x598a64, 'material': _0x232494, 'clampToGround': !![] }, 'polygon': { 'heightReference': Cesium['HeightReference']['None'], 'hierarchy': _0x571529, 'material': _0x4f4b69 } }), _0x1530a8[_0x469362(0x1b4)] = _0x469362(0x194); } else _0x458fdb = _0x469362(0x18b); _0x103f6f[_0x469362(0x130)](_0x4dd6c5); }, Cesium['ScreenSpaceEventType']['LEFT_CLICK']), _0x54bdec[_0x7f4c4e(0x165)](function (_0x5cf7b5) { const _0x547b18 = _0x7f4c4e; let _0x1207d7 = _0x5cf7b5['endPosition']; if (Cesium[_0x547b18(0x132)](_0x1530a8)) { _0x103f6f[_0x547b18(0x177)](); let _0x190177 = getCatesian3FromPX(_0x1fe51f, _0x1207d7); _0x103f6f[_0x547b18(0x130)](_0x190177); } _0x103f6f[_0x547b18(0x1b2)] === 0x3 && (_0x1530a8[_0x547b18(0x13f)][_0x547b18(0x16e)] = Cesium['HeightReference'][_0x547b18(0x1a9)]); }, Cesium[_0x7f4c4e(0x19c)][_0x7f4c4e(0x122)]), _0x54bdec[_0x7f4c4e(0x165)](function (_0x128746) { const _0x2a7b90 = _0x7f4c4e; _0x103f6f['pop'](), _0x1530a8[_0x2a7b90(0x123)] = _0x103f6f, _0xc018f1[_0x2a7b90(0x130)](_0x1530a8), _0x54bdec[_0x2a7b90(0x1b6)](), _0x3af1e3 = ![]; if (typeof _0x498838 == 'function') _0x498838(_0x1530a8); }, Cesium[_0x7f4c4e(0x19c)]['RIGHT_DOWN']), document[_0x7f4c4e(0x18f)] = function (_0x496938) { const _0x315f7b = _0x7f4c4e; if (_0x496938[_0x315f7b(0x175)] && window[_0x315f7b(0x169)][_0x315f7b(0x1a6)] == 0x5a) { if (!_0x3af1e3) return ![]; _0x103f6f[_0x315f7b(0x177)](), _0x103f6f[_0x315f7b(0x1b2)] == 0x2 && (_0x458fdb = _0x315f7b(0x14b)); } }; }; function getCatesian3FromPX(_0x226d27, _0x585de7) { const _0x36f98d = a0_0x3a7236; let _0x1608ee = _0x226d27[_0x36f98d(0x1af)][_0x36f98d(0x150)](_0x585de7), _0xb8347b = null, _0x15d9c2 = ![], _0x51cde6 = ![]; for (let _0x3b910a in _0x1608ee) { let _0x5b085d = _0x1608ee[_0x3b910a]; (_0x5b085d && _0x5b085d['primitive'] instanceof Cesium[_0x36f98d(0x14c)] || _0x5b085d && _0x5b085d[_0x36f98d(0x131)] instanceof Cesium[_0x36f98d(0x179)] || _0x5b085d && _0x5b085d['primitive'] instanceof Cesium[_0x36f98d(0x15b)]) && (_0x15d9c2 = !![]); if (_0x15d9c2) { _0x226d27[_0x36f98d(0x1af)][_0x36f98d(0x18c)](_0x585de7), _0xb8347b = _0x226d27['scene']['pickPosition'](_0x585de7); if (_0xb8347b) { let _0x1f1f80 = Cesium[_0x36f98d(0x19e)]['fromCartesian'](_0xb8347b); if (_0x1f1f80[_0x36f98d(0x19b)] < 0x0) _0x1f1f80[_0x36f98d(0x19b)] = 0x0; let _0x5b586e = Cesium[_0x36f98d(0x199)]['toDegrees'](_0x1f1f80['longitude']), _0x3eaabd = Cesium[_0x36f98d(0x199)]['toDegrees'](_0x1f1f80[_0x36f98d(0x1bb)]), _0x3f74a4 = _0x1f1f80[_0x36f98d(0x19b)]; _0xb8347b = transformWGS84ToCartesian(_0x226d27, { 'lng': _0x5b586e, 'lat': _0x3eaabd, 'alt': _0x3f74a4 }); } } } let _0x1635c1 = _0x226d27[_0x36f98d(0x174)] instanceof Cesium[_0x36f98d(0x173)]; if (!_0x15d9c2 && !_0x1635c1) { let _0x1e2508 = _0x226d27[_0x36f98d(0x1af)][_0x36f98d(0x1bf)][_0x36f98d(0x157)](_0x585de7); if (!_0x1e2508) return null; _0xb8347b = _0x226d27[_0x36f98d(0x1af)][_0x36f98d(0x1ba)][_0x36f98d(0x18c)](_0x1e2508, _0x226d27[_0x36f98d(0x1af)]), _0x51cde6 = !![]; } !_0x15d9c2 && !_0x51cde6 && _0x1635c1 && (_0xb8347b = _0x226d27[_0x36f98d(0x1af)][_0x36f98d(0x1bf)][_0x36f98d(0x16b)](_0x585de7, _0x226d27[_0x36f98d(0x1af)][_0x36f98d(0x1ba)][_0x36f98d(0x17f)])); if (_0xb8347b) { let _0x3852df = transformCartesianToWGS84(_0x226d27, _0xb8347b); return _0x3852df[_0x36f98d(0x172)] < 0x0 && (_0xb8347b = transformWGS84ToCartesian(_0x226d27, _0x3852df, 0.1)), _0xb8347b; } return ![]; } function transformWGS84ToCartesian(_0x1c2207, _0x16d772, _0x9661b2) { const _0x1ef485 = a0_0x3a7236; return _0x16d772 ? Cesium['Cartesian3'][_0x1ef485(0x136)](_0x16d772[_0x1ef485(0x166)] || _0x16d772[_0x1ef485(0x184)], _0x16d772[_0x1ef485(0x1b8)], _0x16d772['alt'] = _0x9661b2 || _0x16d772[_0x1ef485(0x172)], Cesium[_0x1ef485(0x192)][_0x1ef485(0x135)]) : Cesium['Cartesian3'][_0x1ef485(0x160)]; } function transformCartesianToWGS84(_0x4dcef8, _0x1f124a) { const _0x155316 = a0_0x3a7236; let _0x54026d = Cesium[_0x155316(0x192)][_0x155316(0x135)], _0x1f241b = _0x54026d[_0x155316(0x16f)](_0x1f124a); return { 'lng': Cesium[_0x155316(0x199)][_0x155316(0x1ab)](_0x1f241b[_0x155316(0x19f)]), 'lat': Cesium['Math'][_0x155316(0x1ab)](_0x1f241b['latitude']), 'alt': _0x1f241b[_0x155316(0x19b)] }; } function setSessionid(_0x2f2be5) { const _0x4d8703 = a0_0x3a7236; let _0x4187ec = _0x2f2be5 || 0x20, _0x441cf0 = _0x4d8703(0x1a5), _0x40841b = _0x441cf0[_0x4d8703(0x1b2)], _0x21022e = ''; for (let _0x25decb = 0x0; _0x25decb < _0x4187ec; _0x25decb++) { _0x21022e += _0x441cf0[_0x4d8703(0x13b)](Math[_0x4d8703(0x180)](Math[_0x4d8703(0x195)]() * _0x40841b)); } return _0x21022e; } class TerrainExcavation { constructor(_0x221cab, _0x3b958b) { const _0x5ec0d = a0_0x3a7236; if (!_0x221cab) throw new Error(_0x5ec0d(0x163)); this[_0x5ec0d(0x14a)] = _0x221cab, this['options'] = _0x3b958b || {}, this[_0x5ec0d(0x16a)] = this[_0x5ec0d(0x1c4)][_0x5ec0d(0x19b)] || 0x0, this[_0x5ec0d(0x12f)] = _0x3b958b[_0x5ec0d(0x12f)], this[_0x5ec0d(0x1ad)] = _0x3b958b[_0x5ec0d(0x1ad)], this[_0x5ec0d(0x141)] = Cesium[_0x5ec0d(0x183)](_0x3b958b[_0x5ec0d(0x141)], 0x32), this[_0x5ec0d(0x193)](); } [a0_0x3a7236(0x193)]() { const _0xdd17ca = a0_0x3a7236; Object[_0xdd17ca(0x187)](TerrainExcavation[_0xdd17ca(0x137)], { 'show': { 'get': function () { const _0x1d8531 = _0xdd17ca; return this[_0x1d8531(0x19a)]; }, 'set': function (_0x2972cc) { const _0xd3f437 = _0xdd17ca; this[_0xd3f437(0x19a)] = _0x2972cc, this['switchExcavate'](_0x2972cc); } }, 'height': { 'get': function () { const _0x232fa9 = _0xdd17ca; return this[_0x232fa9(0x16a)]; }, 'set': function (_0xe1692b) { const _0x1114d6 = _0xdd17ca; this[_0x1114d6(0x16a)] = _0xe1692b, this[_0x1114d6(0x143)](_0xe1692b); } } }); } [a0_0x3a7236(0x145)]() { const _0x5572f9 = a0_0x3a7236, _0x88dcf2 = this; CreatePolygonOnGround(_0x88dcf2['viewer'], [], { 'color': Cesium['Color'][_0x5572f9(0x12a)][_0x5572f9(0x125)](0.1), 'outlineColor': Cesium[_0x5572f9(0x144)][_0x5572f9(0x17d)], 'outlineWidth': 0x2 }, function (_0x34599e) { const _0x47bb17 = _0x5572f9; console['log'](_0x34599e); const _0x992f67 = _0x34599e[_0x47bb17(0x123)]; _0x88dcf2[_0x47bb17(0x14a)][_0x47bb17(0x1aa)][_0x47bb17(0x1a3)](_0x34599e), _0x88dcf2[_0x47bb17(0x1a0)](_0x992f67); }); return; } [a0_0x3a7236(0x1a0)](_0x2b2456) { const _0x423e5a = a0_0x3a7236; let _0x171ced = this[_0x423e5a(0x14a)]; this[_0x423e5a(0x16d)](); let _0x5d6090 = [], _0x598a3e = Cesium['Cartesian3']['subtract'](_0x2b2456[0x0], _0x2b2456[0x1], new Cesium['Cartesian3']()), _0x3ccb87 = _0x598a3e['x'] > 0x0; this['excavateMinHeight'] = 0x270f; for (let _0x5a7938 = 0x0; _0x5a7938 < _0x2b2456[_0x423e5a(0x1b2)]; ++_0x5a7938) { let _0x5c9c97 = (_0x5a7938 + 0x1) % _0x2b2456[_0x423e5a(0x1b2)], _0x5adf23 = Cesium[_0x423e5a(0x15d)][_0x423e5a(0x16c)](_0x2b2456[_0x5a7938], _0x2b2456[_0x5c9c97], new Cesium[(_0x423e5a(0x15d))]()), _0x40583f = Cesium[_0x423e5a(0x19e)][_0x423e5a(0x1c0)](_0x2b2456[_0x5a7938]), _0x1ac283 = _0x171ced[_0x423e5a(0x1af)][_0x423e5a(0x1ba)][_0x423e5a(0x15e)](_0x40583f) || _0x40583f[_0x423e5a(0x19b)]; console[_0x423e5a(0x1c2)](_0x1ac283); _0x1ac283 < this[_0x423e5a(0x13d)] && (this[_0x423e5a(0x13d)] = _0x1ac283); let _0x21d142 = Cesium[_0x423e5a(0x15d)][_0x423e5a(0x14e)](_0x5adf23, new Cesium[(_0x423e5a(0x15d))]()), _0x1942bc = _0x3ccb87 ? Cesium[_0x423e5a(0x15d)][_0x423e5a(0x1b0)](_0x2b2456[_0x5a7938], _0x5adf23, new Cesium[(_0x423e5a(0x15d))]()) : Cesium['Cartesian3'][_0x423e5a(0x1b0)](_0x2b2456[_0x5c9c97], _0x5adf23, new Cesium[(_0x423e5a(0x15d))]()); _0x1942bc = Cesium[_0x423e5a(0x15d)][_0x423e5a(0x14e)](_0x1942bc, _0x1942bc); let _0x55ff71 = Cesium[_0x423e5a(0x15d)]['cross'](_0x1942bc, _0x21d142, new Cesium['Cartesian3']()); _0x55ff71 = Cesium[_0x423e5a(0x15d)][_0x423e5a(0x14e)](_0x55ff71, _0x55ff71); let _0x3ad36c = new Cesium['Plane'](_0x55ff71, 0x0), _0x27c5bb = Cesium[_0x423e5a(0x178)][_0x423e5a(0x13a)](_0x3ad36c, _0x5adf23); _0x5d6090[_0x423e5a(0x130)](new Cesium[(_0x423e5a(0x14f))](_0x55ff71, _0x27c5bb)); } this[_0x423e5a(0x14a)][_0x423e5a(0x1af)][_0x423e5a(0x1ba)][_0x423e5a(0x196)] = new Cesium[(_0x423e5a(0x1c3))]({ 'planes': _0x5d6090, 'edgeWidth': 0x1, 'edgeColor': Cesium[_0x423e5a(0x144)][_0x423e5a(0x139)], 'enabled': !![] }), this[_0x423e5a(0x186)](_0x2b2456), this[_0x423e5a(0x197)](this['wellData']), this[_0x423e5a(0x14a)][_0x423e5a(0x1aa)][_0x423e5a(0x1a3)](this[_0x423e5a(0x181)]); } [a0_0x3a7236(0x16d)]() { const _0x17553f = a0_0x3a7236; this[_0x17553f(0x14a)][_0x17553f(0x1af)][_0x17553f(0x1ba)]['clippingPlanes'] && (this[_0x17553f(0x14a)][_0x17553f(0x1af)][_0x17553f(0x1ba)]['clippingPlanes'][_0x17553f(0x149)](), this['viewer']['scene'][_0x17553f(0x1a2)]['remove'](this[_0x17553f(0x1bd)]), this[_0x17553f(0x14a)][_0x17553f(0x1af)][_0x17553f(0x1a2)][_0x17553f(0x1a3)](this[_0x17553f(0x17b)]), this[_0x17553f(0x14a)][_0x17553f(0x1af)][_0x17553f(0x126)]()); } ['prepareWell'](_0x2ec3b5) { const _0x21a068 = a0_0x3a7236; let _0x3e4bd9 = _0x2ec3b5[_0x21a068(0x1b2)], _0x235b67 = this[_0x21a068(0x13d)] - this[_0x21a068(0x19b)], _0x466a13 = [], _0x1c1aa4 = [], _0x3b580b = []; for (let _0x1028b5 = 0x0; _0x1028b5 < _0x3e4bd9; _0x1028b5++) { let _0x212229 = _0x1028b5 == _0x3e4bd9 - 0x1 ? 0x0 : _0x1028b5 + 0x1, _0x151ea7 = [Cesium[_0x21a068(0x19e)][_0x21a068(0x1c0)](_0x2ec3b5[_0x1028b5])[_0x21a068(0x19f)], Cesium[_0x21a068(0x19e)]['fromCartesian'](_0x2ec3b5[_0x1028b5])['latitude']], _0x53b9c0 = [Cesium['Cartographic'][_0x21a068(0x1c0)](_0x2ec3b5[_0x212229])[_0x21a068(0x19f)], Cesium[_0x21a068(0x19e)]['fromCartesian'](_0x2ec3b5[_0x212229])[_0x21a068(0x1bb)]]; 0x0 == _0x1028b5 && (_0x3b580b[_0x21a068(0x130)](new Cesium[(_0x21a068(0x19e))](_0x151ea7[0x0], _0x151ea7[0x1])), _0x1c1aa4[_0x21a068(0x130)](Cesium[_0x21a068(0x15d)][_0x21a068(0x164)](_0x151ea7[0x0], _0x151ea7[0x1], _0x235b67)), _0x466a13[_0x21a068(0x130)](Cesium[_0x21a068(0x15d)][_0x21a068(0x164)](_0x151ea7[0x0], _0x151ea7[0x1], 0x0))); for (let _0x20277b = 0x1; _0x20277b <= this[_0x21a068(0x141)]; _0x20277b++) { let _0x11a8ca = Cesium[_0x21a068(0x199)][_0x21a068(0x12b)](_0x151ea7[0x0], _0x53b9c0[0x0], _0x20277b / this[_0x21a068(0x141)]), _0x54822f = Cesium[_0x21a068(0x199)][_0x21a068(0x12b)](_0x151ea7[0x1], _0x53b9c0[0x1], _0x20277b / this['splitNum']); _0x1028b5 == _0x3e4bd9 - 0x1 && _0x20277b == this[_0x21a068(0x141)] || (_0x3b580b[_0x21a068(0x130)](new Cesium[(_0x21a068(0x19e))](_0x11a8ca, _0x54822f)), _0x1c1aa4[_0x21a068(0x130)](Cesium[_0x21a068(0x15d)][_0x21a068(0x164)](_0x11a8ca, _0x54822f, _0x235b67)), _0x466a13[_0x21a068(0x130)](Cesium[_0x21a068(0x15d)]['fromRadians'](_0x11a8ca, _0x54822f, 0x0))); } } this['wellData'] = { 'lerp_pos': _0x3b580b, 'bottom_pos': _0x1c1aa4, 'no_height_top': _0x466a13 }; } [a0_0x3a7236(0x197)](_0x204813) { const _0x5ba653 = a0_0x3a7236; let _0x152a25 = this; if (this[_0x5ba653(0x14a)][_0x5ba653(0x174)]['_layers']) { this[_0x5ba653(0x129)](_0x204813['bottom_pos']); let _0x212a3e = Cesium[_0x5ba653(0x1a8)](this[_0x5ba653(0x14a)][_0x5ba653(0x174)], _0x204813[_0x5ba653(0x155)]); Cesium[_0x5ba653(0x127)](_0x212a3e, function (_0x5ed8d6) { const _0x411e66 = _0x5ba653; let _0x200082 = []; for (let _0x275bb4 = 0x0; _0x275bb4 < _0x5ed8d6[_0x411e66(0x1b2)]; _0x275bb4++) { const _0x3a88cd = _0x5ed8d6[_0x275bb4]; let _0x5aaebb = Cesium['Cartesian3'][_0x411e66(0x164)](_0x3a88cd[_0x411e66(0x19f)], _0x3a88cd[_0x411e66(0x1bb)], _0x3a88cd[_0x411e66(0x19b)]); _0x200082['push'](_0x5aaebb); } _0x152a25[_0x411e66(0x188)](_0x204813['bottom_pos'], _0x200082); }); } else this[_0x5ba653(0x129)](_0x204813[_0x5ba653(0x1c1)]), this[_0x5ba653(0x188)](_0x204813['bottom_pos'], _0x204813[_0x5ba653(0x1b3)]); } [a0_0x3a7236(0x1ac)](_0x2b4ff1) { const _0x3bbc99 = a0_0x3a7236; let _0x17183e = new Cesium[(_0x3bbc99(0x15d))](_0x2b4ff1['x'], _0x2b4ff1['y'], _0x2b4ff1['z']), _0x4610c9 = this[_0x3bbc99(0x14a)][_0x3bbc99(0x1af)][_0x3bbc99(0x1ba)][_0x3bbc99(0x17f)][_0x3bbc99(0x16f)](_0x17183e); return { 'longitude': Cesium['Math']['toDegrees'](_0x4610c9['longitude']), 'latitude': Cesium[_0x3bbc99(0x199)][_0x3bbc99(0x1ab)](_0x4610c9[_0x3bbc99(0x1bb)]), 'altitude': _0x4610c9[_0x3bbc99(0x19b)] }; } [a0_0x3a7236(0x129)](_0x4f20b8) { const _0x59660b = a0_0x3a7236; if (_0x4f20b8[_0x59660b(0x1b2)]) { let _0x4b8dc8 = this[_0x59660b(0x18a)](_0x4f20b8), _0x3fe1fe = []; for (let _0x54ca6e = 0x0; _0x54ca6e < _0x4f20b8[_0x59660b(0x1b2)]; _0x54ca6e++) { let _0x5a3ee0 = this[_0x59660b(0x1ac)](_0x4f20b8[_0x54ca6e]); _0x3fe1fe['push'](_0x5a3ee0[_0x59660b(0x19f)], _0x5a3ee0[_0x59660b(0x1bb)], _0x4b8dc8); } let _0x3ca47e = new Cesium[(_0x59660b(0x156))]({ 'polygonHierarchy': new Cesium['PolygonHierarchy'](Cesium[_0x59660b(0x15d)]['fromDegreesArrayHeights'](_0x3fe1fe)), 'perPositionHeight': !![] }), _0x4dc827 = new Cesium[(_0x59660b(0x18e))]({ 'fabric': { 'type': _0x59660b(0x159), 'uniforms': { 'image': this['bottomImg'] } } }), _0x2737e0 = new Cesium[(_0x59660b(0x190))]({ 'translucent': ![], 'flat': !![], 'material': _0x4dc827 }); this[_0x59660b(0x1bd)] = new Cesium[(_0x59660b(0x12e))]({ 'geometryInstances': new Cesium['GeometryInstance']({ 'geometry': Cesium['PolygonGeometry']['createGeometry'](_0x3ca47e) }), 'appearance': _0x2737e0, 'asynchronous': ![] }), this[_0x59660b(0x14a)][_0x59660b(0x1af)]['primitives'][_0x59660b(0x1a1)](this[_0x59660b(0x1bd)]); } } [a0_0x3a7236(0x188)](_0x725540, _0x1f0300) { const _0x4868d9 = a0_0x3a7236; let _0x161b97 = this[_0x4868d9(0x18a)](_0x725540), _0x44cb3e = [], _0x284489 = []; for (let _0x40a3b3 = 0x0; _0x40a3b3 < _0x1f0300[_0x4868d9(0x1b2)]; _0x40a3b3++) { _0x44cb3e[_0x4868d9(0x130)](this[_0x4868d9(0x1ac)](_0x1f0300[_0x40a3b3])[_0x4868d9(0x1b9)]), _0x284489[_0x4868d9(0x130)](_0x161b97); } let _0x2d4775 = new Cesium[(_0x4868d9(0x1b7))]({ 'positions': _0x1f0300, 'maximumHeights': _0x44cb3e, 'minimumHeights': _0x284489 }), _0x4f2fe0 = Cesium[_0x4868d9(0x1b7)]['createGeometry'](_0x2d4775), _0xefbefd = new Cesium['Material']({ 'fabric': { 'type': _0x4868d9(0x159), 'uniforms': { 'image': this['wallImg'] } } }), _0x3f0316 = new Cesium[(_0x4868d9(0x190))]({ 'translucent': ![], 'flat': !![], 'material': _0xefbefd }); this[_0x4868d9(0x17b)] = new Cesium[(_0x4868d9(0x12e))]({ 'geometryInstances': new Cesium[(_0x4868d9(0x1a7))]({ 'geometry': _0x4f2fe0, 'attributes': { 'color': Cesium[_0x4868d9(0x18d)][_0x4868d9(0x154)](Cesium['Color']['GREY']) }, 'id': _0x4868d9(0x12d) }), 'appearance': _0x3f0316, 'asynchronous': ![] }), this[_0x4868d9(0x14a)][_0x4868d9(0x1af)][_0x4868d9(0x1a2)][_0x4868d9(0x1a1)](this[_0x4868d9(0x17b)]); } ['getMinHeight'](_0x3ae7a2) { const _0x187297 = a0_0x3a7236; let _0x4a629a = 0x4c4b40, _0x4fd3f0 = null; for (let _0x24ce10 = 0x0; _0x24ce10 < _0x3ae7a2[_0x187297(0x1b2)]; _0x24ce10++) { let _0x592f83 = _0x3ae7a2[_0x24ce10]['z']; _0x592f83 < _0x4a629a && (_0x4a629a = _0x592f83, _0x4fd3f0 = this[_0x187297(0x1ac)](_0x3ae7a2[_0x24ce10])); } return _0x4fd3f0['altitude']; } [a0_0x3a7236(0x140)](_0x297785) { const _0x560561 = a0_0x3a7236; _0x297785 ? (this['viewer']['scene'][_0x560561(0x1ba)]['material'] = null, this[_0x560561(0x17b)][_0x560561(0x142)] = !![], this[_0x560561(0x1bd)][_0x560561(0x142)] = !![]) : (this[_0x560561(0x14a)]['scene']['globe'][_0x560561(0x19d)] = null, this[_0x560561(0x17b)]['show'] = ![], this['bottomSurface'][_0x560561(0x142)] = ![]); } ['updateExcavateDepth'](_0x4520ba) { const _0xcb5032 = a0_0x3a7236; this[_0xcb5032(0x14a)][_0xcb5032(0x1af)][_0xcb5032(0x1a2)]['remove'](this['bottomSurface']), this['viewer']['scene']['primitives'][_0xcb5032(0x1a3)](this[_0xcb5032(0x17b)]), console[_0xcb5032(0x1c2)](this[_0xcb5032(0x153)], this[_0xcb5032(0x13d)]); let _0x1fe827 = this[_0xcb5032(0x153)][_0xcb5032(0x155)], _0x2bb0b9 = []; for (let _0x34e3d8 = 0x0; _0x34e3d8 < _0x1fe827[_0xcb5032(0x1b2)]; _0x34e3d8++) { _0x2bb0b9['push'](Cesium[_0xcb5032(0x15d)][_0xcb5032(0x164)](_0x1fe827[_0x34e3d8][_0xcb5032(0x19f)], _0x1fe827[_0x34e3d8][_0xcb5032(0x1bb)], this[_0xcb5032(0x13d)] - _0x4520ba)); } this[_0xcb5032(0x153)]['bottom_pos'] = _0x2bb0b9, this[_0xcb5032(0x197)](this[_0xcb5032(0x153)]); } } function a0_0x1bfb() { const _0x4a265b = ['splitNum', 'show', 'updateExcavateDepth', 'Color', 'startCreate', 'concat', 'outlineColor', 'defaultAccessToken', 'removeAll', 'viewer', '左键添加第二个点', 'Cesium3DTileFeature', '190PsJAiD', 'normalize', 'ClippingPlane', 'drillPick', 'outlineWidth', '3EDcVze', 'wellData', 'fromColor', 'lerp_pos', 'PolygonGeometry', 'getPickRay', 'the\x20id\x20parameter\x20is\x20an\x20unique\x20value', 'Image', 'getById', 'Model', '2234252jfUAgc', 'Cartesian3', 'getHeight', '136stvgyc', 'ZERO', 'cesiumContainer', '_cesiumWidget', 'no\x20viewer\x20object!', 'fromRadians', 'setInputAction', 'lng', 'ScreenSpaceEventHandler', 'flyTo', 'event', '_height', 'pickEllipsoid', 'midpoint', 'clear', 'heightReference', 'cartesianToCartographic', '1292572ZQxntH', 'https://services.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer', 'alt', 'EllipsoidTerrainProvider', 'terrainProvider', 'ctrlKey', '155478mSilNV', 'pop', 'Plane', 'Cesium3DTileset', 'none', 'wellWall', 'position', 'YELLOW', '开始地形开挖', 'ellipsoid', 'floor', 'drawGeomtry', 'createWorldTerrain', 'defaultValue', 'lon', 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJqdGkiOiIxZjI0ZWRkMi1iYjUzLTRlZGYtYjk4Yy0yNTczYzY0YWY1NjgiLCJpZCI6MTY3ODYsImlhdCI6MTY3ODE1NTIyMX0.x0jWIoh2wIH21yx5LCfUnx_kN6Zh6f7zagedKFc1PRw', 'prepareWell', 'defineProperties', 'createWellWall', 'Ion', 'getMinHeight', '左键添加点，Ctrl+Z回退，右键完成绘制', 'pick', 'ColorGeometryInstanceAttribute', 'Material', 'onkeydown', 'MaterialAppearance', 'CallbackProperty', 'Ellipsoid', 'init', 'Polygon', 'random', 'clippingPlanes', 'createWell', 'canvas', 'Math', '_show', 'height', 'ScreenSpaceEventType', 'material', 'Cartographic', 'longitude', 'updateData', 'add', 'primitives', 'remove', '5547768xPAvxi', 'ABCDEFGHJKMNPQRSTWXYZabcdefhijkmnprstwxyz2345678', 'keyCode', 'GeometryInstance', 'sampleTerrainMostDetailed', 'CLAMP_TO_GROUND', 'entities', 'toDegrees', 'ellipsoidToDegree', 'wallImg', 'toFixed', 'scene', 'subtract', '左键点击开始绘制', 'length', 'no_height_top', 'GeoType', '22526lNoGtb', 'destroy', 'WallGeometry', 'lat', 'altitude', 'globe', 'latitude', 'pickPosition', 'bottomSurface', '369675zAOVSI', 'camera', 'fromCartesian', 'bottom_pos', 'log', 'ClippingPlaneCollection', 'options', 'MOUSE_MOVE', 'pottingPoint', '../static/images/excavate_side_min.jpg', 'withAlpha', 'render', 'when', '_creditContainer', 'createBottomSurface', 'RED', 'lerp', '4347910OLcKXN', 'PitWall', 'Primitive', 'bottomImg', 'push', 'primitive', 'defined', 'display', 'Cesium', 'WGS84', 'fromDegrees', 'prototype', 'Viewer', 'WHITE', 'getPointDistance', 'charAt', 'LEFT_CLICK', 'excavateMinHeight', '结束地形开挖', 'polygon', 'switchExcavate']; a0_0x1bfb = function () { return _0x4a265b; }; return a0_0x1bfb(); } var viewer = undefined, terrainClipPlanObj = undefined, height = 0xc8; let key = a0_0x3a7236(0x185); Cesium[a0_0x3a7236(0x189)][a0_0x3a7236(0x148)] = key, viewer = viewer = new Cesium[(a0_0x3a7236(0x138))](a0_0x3a7236(0x161), { 'imageryProvider': new Cesium['ArcGisMapServerImageryProvider']({ 'url': a0_0x3a7236(0x171) }), 'terrainProvider': Cesium[a0_0x3a7236(0x182)](), 'geocoder': !![], 'homeButton': !![], 'sceneModePicker': !![], 'baseLayerPicker': !![], 'navigationHelpButton': !![], 'animation': !![], 'timeline': !![], 'fullscreenButton': !![], 'vrButton': !![], 'selectionIndicator': ![], 'infoBox': ![] }), viewer[a0_0x3a7236(0x162)][a0_0x3a7236(0x128)]['style'][a0_0x3a7236(0x133)] = a0_0x3a7236(0x17a), initCamera(); function heightChange(_0x4adf5e) { terrainClipPlanObj && (terrainClipPlanObj['height'] = _0x4adf5e); } function terrainClip(_0x5c8da8) { const _0x28f3ff = a0_0x3a7236; !terrainClipPlanObj && (terrainClipPlanObj = new TerrainExcavation(viewer, { 'height': height, 'splitNum': 0x3e8, 'bottomImg': '../static/images/excavate_bottom_min.jpg', 'wallImg': _0x28f3ff(0x124) })), _0x5c8da8 ? (console[_0x28f3ff(0x1c2)](_0x28f3ff(0x17e)), terrainClipPlanObj['startCreate']()) : (console['log'](_0x28f3ff(0x13e)), terrainClipPlanObj[_0x28f3ff(0x16d)]()); } function initCamera() { const _0x379890 = a0_0x3a7236; viewer['camera'][_0x379890(0x168)]({ 'destination': Cesium['Cartesian3'][_0x379890(0x136)](0x6e, 0x28, 0x2710), 'orientation': { 'heading': 0.09085393067733083, 'pitch': -1.5329743385768886, 'roll': 0x0 }, 'duration': 0x3 }); } function getLocation() { const _0x163195 = a0_0x3a7236; let _0x309f24 = new Cesium[(_0x163195(0x167))](viewer[_0x163195(0x198)]); _0x309f24[_0x163195(0x165)](function (_0x242743) { const _0x12274b = _0x163195; let _0x2e2d26 = viewer[_0x12274b(0x1af)][_0x12274b(0x1bc)](_0x242743[_0x12274b(0x17c)]); if (Cesium[_0x12274b(0x132)](_0x2e2d26)) { let _0x22a035 = Cesium[_0x12274b(0x19e)]['fromCartesian'](_0x2e2d26), _0x1545e6 = Cesium['Math'][_0x12274b(0x1ab)](_0x22a035[_0x12274b(0x19f)])['toFixed'](0x5), _0x311099 = Cesium[_0x12274b(0x199)][_0x12274b(0x1ab)](_0x22a035[_0x12274b(0x1bb)])[_0x12274b(0x1ae)](0x5), _0x307afa = _0x22a035[_0x12274b(0x19b)][_0x12274b(0x1ae)](0x2); console['log'](_0x2e2d26, { 'lon': _0x1545e6, 'lat': _0x311099, 'height': _0x307afa }); } }, Cesium['ScreenSpaceEventType'][_0x163195(0x13c)]); }
    </script>
</body>

</html>